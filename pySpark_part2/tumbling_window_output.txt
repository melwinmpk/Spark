{"CreatedTime": "2019-02-05 10:05:00", "Type": "BUY", "Amount": 500, "BrokerCode": "ABX"}
{"CreatedTime": "2019-02-05 10:12:00", "Type": "BUY", "Amount": 300, "BrokerCode": "ABX"}
{"CreatedTime": "2019-02-05 10:20:00", "Type": "BUY", "Amount": 800, "BrokerCode": "ABX"}
{"CreatedTime": "2019-02-05 10:40:00", "Type": "BUY", "Amount": 900, "BrokerCode": "ABX"}
{"CreatedTime": "2019-02-05 10:25:00", "Type": "SELL", "Amount": 400, "BrokerCode": "ABX"}
{"CreatedTime": "2019-02-05 10:48:00", "Type": "SELL", "Amount": 600, "BrokerCode": "ABX"}
{"CreatedTime": "2019-02-05 10:05:00", "Type": "SELL", "Amount": 600, "BrokerCode": "ABX"}
{"CreatedTime": "2019-02-05 09:05:00", "Type": "SELL", "Amount": 600, "BrokerCode": "ABX"}


output
-------------------------------------------
Batch: 0
-------------------------------------------
+-----+---+--------+---------+
|start|end|TotalBuy|TotalSell|
+-----+---+--------+---------+
+-----+---+--------+---------+

-------------------------------------------
Batch: 1
-------------------------------------------
+-------------------+-------------------+--------+---------+
|              start|                end|TotalBuy|TotalSell|
+-------------------+-------------------+--------+---------+
|2019-02-05 10:15:00|2019-02-05 10:30:00|     800|      400|
|2019-02-05 10:00:00|2019-02-05 10:15:00|     800|        0|
|2019-02-05 10:30:00|2019-02-05 10:45:00|     900|        0|
+-------------------+-------------------+--------+---------+

-------------------------------------------
Batch: 2
-------------------------------------------
+-------------------+-------------------+--------+---------+
|              start|                end|TotalBuy|TotalSell|
+-------------------+-------------------+--------+---------+
|2019-02-05 10:15:00|2019-02-05 10:30:00|     800|      400|
|2019-02-05 10:45:00|2019-02-05 11:00:00|       0|      600|
|2019-02-05 10:00:00|2019-02-05 10:15:00|     800|        0|
|2019-02-05 10:30:00|2019-02-05 10:45:00|     900|        0|
+-------------------+-------------------+--------+---------+



